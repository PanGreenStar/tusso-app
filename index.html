<!DOCTYPE html>
<html lang="vi">
<head>


<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-512.png">

<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Tusso">



<meta charset="UTF-8">
<title>Qu·∫£n l√Ω qu√°n</title>

<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display",
                 "Segoe UI", sans-serif;
    background: #f5f5f7;
    padding: 20px;
    color: #1c1c1e;
}


.area-title {
    margin-top: 30px;
    margin-bottom: 10px;
    font-size: 20px;
    font-weight: 600;
    color: #1c1c1e;
}


.area {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
}

.card {
    background: rgba(255,255,255,0.95);
    width: 260px;
    padding: 14px;
    border-radius: 20px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.08);
    backdrop-filter: blur(10px);
    transition: all 0.25s ease;
}

.card:hover {
    transform: translateY(-3px);
}

.card.playing {
    background: rgba(255,255,255,0.98);
    box-shadow:
        0 0 0 2px #34c759,
        0 18px 40px rgba(0,0,0,0.15);
}



button {
    border: none;
    border-radius: 14px;
    padding: 10px;
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    transition: transform 0.15s ease, opacity 0.15s ease;
}
button:active {
    transform: scale(0.96);
}



.mode-after, .mode-before {
    width: 49%;
    background: #e5e5ea;
    color: #1c1c1e;
}

.mode-after.active,
.mode-before.active {
    background: #007aff;
    color: white;
}

.mode-before { background:#9b59b6; color:white; width:48%; }

.start {
    background: #34c759;
    color: white;
}

.end {
    background: #ff3b30;
    color: white;
}


.prepaid {
    width: 100%;
    padding: 8px;
    margin-top: 6px;
}

.menu-toggle {
    width: 100%;
    margin-top: 8px;
    padding: 10px;
    border-radius: 16px;
    background: #f2f2f7;
    color: #007aff;
    font-weight: 600;
}

.menu-toggle:active {
    background: #e5e5ea;
}


.menu {
    background: rgba(255,255,255,0.96);
    border-radius: 18px;

    max-height: 0;
    overflow: hidden;     /* QUAN TR·ªåNG */
    padding: 0;           /* ‚Üê kh√¥ng padding khi ƒë√≥ng */

    transition: max-height 0.35s cubic-bezier(.4,0,.2,1);
}

.menu.show {
    max-height: 320px;
    padding: 6px 0;       /* ‚Üê ch·ªâ padding khi m·ªü */
    overflow-y: auto;
}




.menu-item span {
    transition: transform 0.12s ease;
}

.menu-item button:disabled {
    opacity: 0.4;
}


.menu-item {
    display: flex;
    justify-content: space-between;
    align-items: center;

    padding: 10px 14px;
    border-bottom: 1px solid #e5e5ea;
    font-size: 15px;
}


.menu-item:last-child {
    border-bottom: none;
}

.menu-item > div {
    display: flex;
    align-items: center;
    gap: 10px;
}

.menu-item button {
    width: 28px;
    height: 28px;
    border-radius: 50%;

    display: flex;
    align-items: center;
    justify-content: center;

    background: #007aff;
    color: white;

    font-size: 18px;
    font-weight: 600;
    line-height: 28px; /* QUAN TR·ªåNG */

    padding: 0;
}



.menu-item div span {
    min-width: 20px;
    text-align: center;
    font-weight: 600;
    color: #1c1c1e;
}



.menu-item button {
    background: #007aff;
    font-weight: bold;
}


.info {
    background: #f2f2f7;
    padding: 10px;
    border-radius: 14px;
    font-size: 14px;
    line-height: 1.6;
    margin-top: 10px;
}


.total {
    font-size: 28px;
    font-weight: 600;
    color: #34c759;
    margin-bottom: 24px;
}

</style>
</head>

<body>

<h1>H·ªÜ TH·ªêNG QU·∫¢N L√ù QU√ÅN</h1>
<div class="total">Doanh thu h√¥m nay: <span id="dailyTotal">0 ƒë</span></div>

<div class="area-title">üèê S√¢n b√≥ng chuy·ªÅn</div>
<div class="area" id="volleyballArea"></div>

<div class="area-title">üéÆ M√°y game</div>
<div class="area" id="gameArea"></div>

<div class="area-title">‚öΩ S√¢n 5 ng∆∞·ªùi</div>
<div class="area" id="football5Area"></div>

<div class="area-title">‚öΩ S√¢n 7 ng∆∞·ªùi</div>
<div class="area" id="football7Area"></div>


<div class="area-title">üé± Khu Bida</div>
<div class="area" id="bidaArea"></div>

<script>
/* ===== C·∫§U H√åNH ===== */
const PRICE = {
    bida: 30000,
    volleyball: 70000,
    game: 20000,
    football5: 150000,
    football7: 300000
};


const menuList = [
    { name:"Sting", price:10000 },
    { name:"Number1 v√†ng", price:10000 },
    { name:"N∆∞·ªõc L·ªçc", price:5000 },
    { name:"Pepsi", price:10000 },
    { name:"7 up", price:10000 },
    { name:"Revive", price:10000 },
    { name:"√î long", price:10000 },
    { name:"Soya ƒë·∫≠u n√†nh", price:10000 },
    { name:"M√¨ 3 mi·ªÅn", price:5000 },
    { name:"M√¨ Indomie", price:10000 },
    { name:"1 Vi√™n b√≤", price:5000 },
    { name:"2 X√∫c x√≠ch nh·ªè", price:5000 },
    { name:"X√∫c x√≠ch l·ªõn", price:10000 },
    { name:"Tr·ª©ng x√∫c x√≠ch", price:10000 },
    { name:"N", price:17000 },
    { name:"SB", price:17000 },
    { name:"SM", price:22000 },
    { name:"Z", price:25000 }
];

let dailyRevenue = 0;

/* ===== H√ÄM CHUNG ===== */
function money(n){ return n.toLocaleString("vi-VN")+" ƒë"; }
function time(t){ return t.toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}); }
function updateDaily(){ document.getElementById("dailyTotal").innerText = money(dailyRevenue); }

/* ===== T·∫†O B√ÄN ===== */
function createArea(areaId, title, count, price){
    const area = document.getElementById(areaId);

    for(let i=1;i<=count;i++){
        const card = document.createElement("div");
        card.className="card";
        const machineName = `${title} ${i}`;

        card.innerHTML = `
    <h3>${title} ${i}</h3>

    <button class="mode-after">Tr·∫£ sau</button>
    <button class="mode-before">Tr·∫£ tr∆∞·ªõc</button>

    <input class="prepaid" type="number" placeholder="Ti·ªÅn tr·∫£ tr∆∞·ªõc">

    <div class="control" style="display:none">
        <button class="start">‚ñ∂ B·∫Øt ƒë·∫ßu</button>
        <button class="end">‚ñ† K·∫øt th√∫c</button>
    </div>

    <div class="menu-toggle">‚ò∞ Menu</div>
    <div class="menu"></div>

    <div class="info"></div>
`;

        area.appendChild(card);

        let mode = null;
        let startTime = null;
        let endTime = null; 
        let menuTotal = 0;
        let menuCount = {};
        let timer = null;

        const prepaidInput = card.querySelector(".prepaid");
        prepaidInput.style.display = "none";

        const control = card.querySelector(".control");
        const info = card.querySelector(".info");
        const menuDiv = card.querySelector(".menu");
        const btnAfter = card.querySelector(".mode-after");
        const btnBefore = card.querySelector(".mode-before");


        /* MENU */
        menuList.forEach(item=>{
            menuCount[item.name]=0;
            const row=document.createElement("div");
            row.className="menu-item";
            row.innerHTML = `
    <span>${item.name} (${money(item.price)})</span>
    <div>
    <button>-</button>
    <span class="menu-qty">0</span>
    <button>+</button>
</div>

`;

           const qty = row.querySelector("div span");

            const btns=row.querySelectorAll("button");
            btns[0].disabled = true; // l√∫c ƒë·∫ßu kh√¥ng cho tr·ª´


           btns[0].onclick = () => {
    if (!startTime) return;

    if (menuCount[item.name] > 0) {
        menuCount[item.name]--;
        menuTotal -= item.price;
        qty.innerText = menuCount[item.name];

        // hi·ªáu ·ª©ng iOS
        qty.style.transform = "scale(1.2)";
        setTimeout(() => qty.style.transform = "scale(1)", 120);
    }

    btns[0].disabled = menuCount[item.name] === 0;
};


btns[1].onclick = () => {
    if (!startTime) return;

    if (mode === "before") {
        const prepaid = Number(prepaidInput.value);
        if (menuTotal + item.price > prepaid) {
            info.innerHTML += `<span style="color:red">Kh√¥ng ƒë·ªß ti·ªÅn tr·∫£ tr∆∞·ªõc</span><br>`;
            return;
        }
    }

    menuCount[item.name]++;
    menuTotal += item.price;
    qty.innerText = menuCount[item.name];

    // hi·ªáu ·ª©ng iOS
    qty.style.transform = "scale(1.2)";
    setTimeout(() => qty.style.transform = "scale(1)", 120);

    btns[0].disabled = false;
};



            menuDiv.appendChild(row);
        });

      const toggle = card.querySelector(".menu-toggle");

toggle.onclick = () => {
    if (!startTime) {
    alert("B·∫•m B·∫Øt ƒë·∫ßu tr∆∞·ªõc khi g·ªçi m√≥n");
    return;
}

    menuDiv.classList.toggle("show");
    toggle.innerText = menuDiv.classList.contains("show")
        ? "‚úï ƒê√≥ng menu"
        : "‚ò∞ Menu";
};



        card.querySelector(".mode-after").onclick=()=>{
            mode="after";
            prepaidInput.style.display="none";
             control.style.display = "block"; 
        };

        card.querySelector(".mode-before").onclick=()=>{
            mode="before";
            prepaidInput.style.display="block";
             control.style.display = "block"; 
        };

        card.querySelector(".start").onclick = () => {
            if(timer) return;

    if(!mode){ alert("Ch·ªçn Tr·∫£ tr∆∞·ªõc ho·∫∑c Tr·∫£ sau"); return; }
    if(mode==="before" && !prepaidInput.value){ alert("Nh·∫≠p ti·ªÅn tr·∫£ tr∆∞·ªõc"); return; }

    startTime = new Date();
    card.classList.add("playing");

    if(mode === "before"){
        const prepaid = Number(prepaidInput.value);
        const seconds = prepaid / price * 3600;
        endTime = new Date(startTime.getTime() + seconds * 1000);
    }

    timer = setInterval(() => {
    let html = `Gi·ªù b·∫Øt ƒë·∫ßu: ${time(startTime)}<br>`;

    if (mode === "before") {
        const prepaid = Number(prepaidInput.value);
        const remainMoney = prepaid - menuTotal;

        if (remainMoney <= 0) {
            html += `<span style="color:red">H·∫øt ti·ªÅn (do menu)</span><br>`;
        } else {
            const remainSeconds = remainMoney / price * 3600;
           const now = new Date();
const remainEnd = new Date(now.getTime() + remainSeconds * 1000);

            html += `Gi·ªù k·∫øt th√∫c d·ª± ki·∫øn: ${time(remainEnd)}<br>`;
            html += `Ti·ªÅn c√≤n l·∫°i: ${money(remainMoney)}<br>`;
        }
    }

    html += `Ti·ªÅn menu: ${money(menuTotal)}`;
    info.innerHTML = html;
}, 1000);
};





        card.querySelector(".end").onclick = () => {
    if(!startTime) return;
    clearInterval(timer);

    const realEndTime = new Date();
    const minutes = Math.ceil((realEndTime - startTime) / 60000);
    const moneyTime = Math.ceil(minutes / 60 * price);

    let refund = 0;
    if(mode === "before"){
        refund = Number(prepaidInput.value) - moneyTime - menuTotal;
        if(refund < 0) refund = 0;
    }

let menuDetail = "";
Object.keys(menuCount).forEach(name => {
    if (menuCount[name] > 0) {
        menuDetail += `- ${name} x ${menuCount[name]}\n`;
    }
});
if (!menuDetail) menuDetail = "Kh√¥ng g·ªçi m√≥n\n";


    dailyRevenue += moneyTime + menuTotal;
    updateDaily();

    alert(
    `${title} ${i}\n\n` +
    `Gi·ªù b·∫Øt ƒë·∫ßu: ${time(startTime)}\n` +
    `Gi·ªù k·∫øt th√∫c: ${time(realEndTime)}\n` +
    `Th·ªùi gian: ${minutes} ph√∫t\n` +
    `Ti·ªÅn gi·ªù: ${money(moneyTime)}\n` +
    `Ti·ªÅn menu: ${money(menuTotal)}\n\n` +
    `Chi ti·∫øt menu:\n${menuDetail}` +
    (mode==="before" ? `\nTr·∫£ l·∫°i kh√°ch: ${money(refund)}` : "")
);



    info.innerHTML = `
<b>${title} ${i}</b><br>
Gi·ªù b·∫Øt ƒë·∫ßu: ${time(startTime)}<br>
Gi·ªù k·∫øt th√∫c: ${time(realEndTime)}<br>
Ti·ªÅn gi·ªù: ${money(moneyTime)}<br>
Ti·ªÅn menu: ${money(menuTotal)}<br>
<pre style="margin-top:6px">${menuDetail}</pre>
`;



    card.classList.remove("playing");
startTime = null;

menuTotal = 0;
prepaidInput.value = "";

Object.keys(menuCount).forEach(k => menuCount[k] = 0);

menuDiv.querySelectorAll(".menu-qty")
    .forEach(qty => qty.innerText = "0");

menuDiv.querySelectorAll(".menu-item button:first-child")
    .forEach(btn => btn.disabled = true);

menuDiv.classList.remove("show");
card.querySelector(".menu-toggle").innerText = "‚ò∞ Menu";

timer = null;
control.style.display = "none";



timer = null;

    control.style.display = "none";
};
    }
      }
            

createArea("bidaArea", "Bida", 14, PRICE.bida);
createArea("volleyballArea", "B√≥ng chuy·ªÅn", 1, PRICE.volleyball);
createArea("gameArea", "M√°y game", 3, PRICE.game);
createArea("football5Area", "S√¢n 5 ng∆∞·ªùi", 2, PRICE.football5);
createArea("football7Area", "S√¢n 7 ng∆∞·ªùi", 1, PRICE.football7);

</script>

</body>
</html>
